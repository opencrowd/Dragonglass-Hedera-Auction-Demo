# Backend for Dragonglass Auction Demo With Hedera Consensus Service (HCS) Messages

## Overview
This project is the backend for the Dragonglass Auction Demo which showcases the HCS message subscription feature of Dragonglass, a OpenCrowd product.
The demo is an auction engine based on HCS messages.  

This demo creates the auction, starts an auction, and allows participants with Hedera Hashgraph accounts to bid in tiny bars in a time-limited auction. 
After auction start, the highest bidder and the amount are displayed and the past bids are also shown in the descending order of bidding time. 
At the end of the auction, the winner will be declared.  

In the demo, the HCS messages generated by the auction are subscribed via Dragonglass and used to power the display of highest bid, bidding history and the winner at the end of the auction.  

## Description
This backend server provides the following rest API endpoints for the auction:  

- /hcs/auction/newAuction/{biddingTimeSec}: creates a new auction by creating and new 
HCS topic and returns the topic id. The duration of the auction in seconds can be specified.
- /hcs/auction/startTimer/{topicId}: starts the auction by sending a HCS message
- /hcs/auction/bid/{bidder}/{amount}/{topicId}: posts a bid and also starts random bidding 
  by sending HCS messages containing the bidder name, the amount and the auction topic ID. 
  Only a higher bid will be allowed to send a HCS message.
- /hcs/auction/end/{topicId}: ends the auction by sending a HCS message containing the 
  auction topic ID, the highest bid, and the winner

## Quickstart

### Requirements

- JDK 11
- [Hedera Java SDK](https://github.com/hashgraph/hedera-sdk-java.git)

### Installation
```bash
git clone https://github.com/opencrowd/Dragonglass-Hedera-Auction-Demo.git
cd Dragonglass-Hedera-Auction-Demo/auction
nano src/main/resources/application-mainnet.yml # Insert account information
(for testnet run: nano src/main/resources/application-testnet.yml # Insert account information)
./mvnw clean install
```
### Yaml Profile Configuration
```text
hedera.account:
  Alice:
    ID: 0.0.x
    KEY: <your account's private key in hex, length of 96 characters>
  manager:
    ID: 0.0.x
    KEY: <your account's private key in hex, length of 96 characters>
```
### Running against mainnet
mvn spring-boot:run -Dspring-boot.run.profiles=mainnet

### Running against testnet
mvn spring-boot:run -Dspring-boot.run.profiles=testnet

### REST API access
Once the auction server is running, click this link: 
[Dragonglass Auction Demo Rest API](http://localhost:8081/swagger-ui.html#/)

To change the port, edit server.port in src/main/resources/application.yml # Insert account information

### Project structure
- ./README.md: this file
- ./pom.xml
- ./src/main/java: java source code
- ./src/main/resources: yml config files

## Developer Contact
Hua Li, OpenCrowd, hli@opencrowd.com

